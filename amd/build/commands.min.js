define("tiny_multilang2/commands",["exports","./options","./common","core/str","./ui","editor_tiny/utils"],(function(_exports,_options,_common,_str,_ui,_utils){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSetup=void 0;_exports.getSetup=async()=>{const[buttonText,tooltip,removeTag,selectErr,langTagErr]=await(0,_str.get_strings)(["multilang2:language","multilang2:desc","multilang2:removetag","multilang2:multiBlockElements","multilang2:langTagsInSelection"].map((key=>({key:key,component:_common.component})))),[buttonImage]=await Promise.all([(0,_utils.getButtonImage)("icon",_common.component)]);return editor=>{const languageList=(0,_options.getLanguageList)(editor);if(!(languageList.length<2)){if(editor.ui.registry.addIcon(_common.buttonIcon,buttonImage.html),editor.ui.registry.addSplitButton(_common.component,{icon:_common.buttonIcon,tooltip:tooltip,fetch:function(callback){callback(languageList.map((lang=>({type:"choiceitem",value:lang.iso,text:lang.label}))))},onAction:()=>{(0,_ui.applyLanguage)(editor,null)},onItemAction:(_splitButtonApi,value)=>{(0,_ui.applyLanguage)(editor,value)}}),editor.ui.registry.addNestedMenuItem(_common.component,{icon:_common.buttonIcon,text:buttonText,getSubmenuItems:()=>languageList.map((lang=>({type:"menuitem",text:lang.label,onAction:()=>{(0,_ui.applyLanguage)(editor,lang.iso)}})))}),!(0,_options.showAllLanguages)(editor)||(0,_options.isAddLanguage)(editor)){for(const lang of languageList)editor.ui.registry.addButton(_common.component+"_remove",{icon:"remove",tooltip:removeTag,onAction:()=>{(0,_ui.onDelete)(editor,event)}}),"remove"!==lang.iso&&editor.ui.registry.addButton(_common.component+"_"+lang.iso,{text:lang.iso,tooltip:lang.label,onAction:()=>{(0,_ui.applyLanguage)(editor,lang.iso,event)}});editor.ui.registry.addContextToolbar(_common.component,{predicate:function(node){return node.classList.contains("multilang-begin")||node.classList.contains("multilang-end")},items:languageList.map((lang=>_common.component+"_"+lang.iso)).join(" "),position:"node",scope:"node"})}editor.on("init",(()=>{(0,_ui.onInit)(editor,{multipleBlocksErrMsg:selectErr,langInSelectionErrMsg:langTagErr})})),editor.on("BeforeGetContent",(format=>{(0,_ui.onBeforeGetContent)(editor,format)})),editor.on("focus",(()=>{(0,_ui.onFocus)(editor)})),editor.on("submit",(()=>{(0,_ui.onSubmit)(editor)})),editor.on("keydown",(event=>{(0,_ui.onDelete)(editor,event)}))}}}}));

//# sourceMappingURL=commands.min.js.map